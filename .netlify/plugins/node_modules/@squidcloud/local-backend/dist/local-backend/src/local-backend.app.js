"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.bootstrapLocalBackend = void 0;
const local_backend_module_1 = require("./local-backend.module");
const core_1 = require("@nestjs/core");
const assertic_1 = require("assertic");
if (!process.env['SQUID_DEVELOPER_ID']) {
    console.error(`Error: No '.env' file detected.

The '.env' file is essential to run your Squid backend locally. It should include necessary information like your application ID, Squid developer ID, and other important variables.

To generate a '.env' file, click "Create .env file" button in https://console.squid.cloud and follow the instructions.

Once the '.env' file is created, run the Squid backend again.`);
    process.exit(1);
}
const minVersion = 18;
const nodeVersion = parseInt(process.version.split('.')[0].slice(1));
if (nodeVersion < minVersion) {
    console.error(`Error: Squid requires Node.js version ${minVersion} or higher. You are using version ${process.version}.`);
    process.exit(1);
}
async function bootstrapLocalBackend(module) {
    const app = await core_1.NestFactory.create(module, {
        rawBody: true,
    });
    app.useBodyParser('json', { limit: '50mb' });
    app.useGlobalInterceptors((0, assertic_1.truthy)(app.get(local_backend_module_1.BodyInterceptor)));
    await app.listen(8020);
}
exports.bootstrapLocalBackend = bootstrapLocalBackend;
//# sourceMappingURL=local-backend.app.js.map