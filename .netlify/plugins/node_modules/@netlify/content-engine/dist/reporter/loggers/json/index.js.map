{"version":3,"file":"index.js","names":["_index","require","_stripAnsi","_interopRequireDefault","isStringPayload","action","payload","sanitizeAction","copiedAction","_cloneDeep2","default","text","stripAnsi","statusText","initializeJSONLogger","onLogAction","sanitizedAction","process","stdout","write","JSON","stringify"],"sources":["../../../../src/reporter/loggers/json/index.ts"],"sourcesContent":["import { onLogAction } from \"../../redux/index\";\nimport { ActionsUnion, ISetStatus } from \"../../redux/types\";\nimport stripAnsi from \"strip-ansi\";\nimport { cloneDeep } from \"lodash\";\n\nconst isStringPayload = (action: ActionsUnion): action is ISetStatus =>\n  typeof action.payload === `string`;\n\nconst sanitizeAction = (action: ActionsUnion): ActionsUnion => {\n  const copiedAction = cloneDeep(action);\n\n  if (isStringPayload(copiedAction)) {\n    return copiedAction;\n  }\n\n  if (`text` in copiedAction.payload && copiedAction.payload.text) {\n    copiedAction.payload.text = stripAnsi(copiedAction.payload.text);\n  }\n  if (`statusText` in copiedAction.payload && copiedAction.payload.statusText) {\n    copiedAction.payload.statusText = stripAnsi(\n      copiedAction.payload.statusText,\n    );\n  }\n\n  return copiedAction;\n};\n\nexport function initializeJSONLogger(): void {\n  onLogAction((action: ActionsUnion) => {\n    const sanitizedAction = sanitizeAction(action);\n\n    process.stdout.write(JSON.stringify(sanitizedAction) + `\\n`);\n  });\n}\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAAC,UAAA,GAAAC,sBAAA,CAAAF,OAAA;AAGA,MAAMG,eAAe,GAAIC,MAAoB,IAC3C,OAAOA,MAAM,CAACC,OAAO,KAAM,QAAO;AAEpC,MAAMC,cAAc,GAAIF,MAAoB,IAAmB;EAC7D,MAAMG,YAAY,GAAG,IAAAC,WAAA,CAAAC,OAAA,EAAUL,MAAM,CAAC;EAEtC,IAAID,eAAe,CAACI,YAAY,CAAC,EAAE;IACjC,OAAOA,YAAY;EACrB;EAEA,IAAK,MAAK,IAAIA,YAAY,CAACF,OAAO,IAAIE,YAAY,CAACF,OAAO,CAACK,IAAI,EAAE;IAC/DH,YAAY,CAACF,OAAO,CAACK,IAAI,GAAG,IAAAC,kBAAS,EAACJ,YAAY,CAACF,OAAO,CAACK,IAAI,CAAC;EAClE;EACA,IAAK,YAAW,IAAIH,YAAY,CAACF,OAAO,IAAIE,YAAY,CAACF,OAAO,CAACO,UAAU,EAAE;IAC3EL,YAAY,CAACF,OAAO,CAACO,UAAU,GAAG,IAAAD,kBAAS,EACzCJ,YAAY,CAACF,OAAO,CAACO,UACvB,CAAC;EACH;EAEA,OAAOL,YAAY;AACrB,CAAC;AAEM,SAASM,oBAAoBA,CAAA,EAAS;EAC3C,IAAAC,kBAAW,EAAEV,MAAoB,IAAK;IACpC,MAAMW,eAAe,GAAGT,cAAc,CAACF,MAAM,CAAC;IAE9CY,OAAO,CAACC,MAAM,CAACC,KAAK,CAACC,IAAI,CAACC,SAAS,CAACL,eAAe,CAAC,GAAI,IAAG,CAAC;EAC9D,CAAC,CAAC;AACJ"}